extends layout
    
block content

    style.
        body {  padding: 50px;  font: 14px "Lucida Grande", Helvetica, Arial, sans-serif;}
        a { color: #00b7ff;}
        
    script(src='http://cdn.bootcss.com/jquery/2.0.3/jquery.min.js')
    script(src='http://cdn.bootcss.com/canvasjs/1.7.0/canvasjs.min.js')

    .page-header
        h1 红岭创投净值标利率曲线
    div(id='chartContainer', style='height:400px; width:100%' )
    
    div(id='chartContainer2', style='height:400px; width:100%' )
    p 日K线数据需要一定的积累过程
    
    br

    script.
        function f1() {
            var dPoints = !{ JSON.stringify(doc.data) };
            var max=0,min=100;
            dPoints.forEach(function (doc) {
                doc.x = new Date(doc.x);
                if (max<doc.y) max=doc.y;
                if (min>doc.y) min=doc.y;
            });
            
            dPoints.forEach(function (doc) {
                if (max == doc.y) {
                    doc.indexLabel = "最高";
                    doc.markerColor = "red";
                    doc.markerType = "triangle";
                }
                
                if (min == doc.y) {
                    doc.indexLabel = "最低";
                    doc.markerColor = "DarkSlateGrey";
                    doc.markerType = "cross";
                }
            });

            var chart = new CanvasJS.Chart("chartContainer",
                {
                    theme: "theme2",
                    title: {
                        horizontalAlign: "left",
                        margin : 20,
                        text: "24小时曲线",
                        fontSize : 23
                    },
                    animationEnabled: true,
                    axisX: {
                        valueFormatString: "HH:mm",
                        interval: 90,
                        intervalType: "minute"

                    },
                    axisY: {
                        includeZero: false
                    },
                    data: [
                        {
                            type: "line",
                            dataPoints: dPoints
                        }
                    ]
                }
                );

            chart.render();
        };
        
        function f2() {
            var dPoints = !{ JSON.stringify(doc.data2) };
            dPoints.forEach(function (doc) {
               doc.x = new Date(doc.x);
            });
            
            var chart = new CanvasJS.Chart("chartContainer2",
                {
                    theme: "theme2",
                    title: {
                        horizontalAlign: "left",
                        margin : 20,
                        text: "日K线",
                        fontSize : 23
                    },
                    animationEnabled: true,
                    axisX: {
                        valueFormatString: "YYYY-MM-DD",
                        interval: 1,
                        intervalType: "week"
                    },
                    axisY: {
                        includeZero: false
                    },
                    data: [
                        {
                            type: "candlestick",
                            risingColor: "#F54545",
                            color:"#0F990F",
                            dataPoints: dPoints
                        }
                    ]
                }
                );

            chart.render();
        };
        
        $( document ).ready(function() {
            f1();
            f2();
        });

    p 欢迎大家提意见
    p 作者id: diwulechao2
    p email: diwulechao@163.com
    p 取样间隔15分钟，取样方法为1月净值标利率最高10标之平均值
